{{define "content"}}
<div class="devices-container">
    <!-- Поиск -->
    <div class="search-section">
        <form action="/devices" method="GET">
            <input type="text" name="search" placeholder="Поиск" value="{{.Search}}">
        </form>
    </div>

    <!-- Сетка устройств -->
    <div class="devices-grid">
        {{range .Devices}}
        <div class="device-card">
            <img src="{{.ImageURL}}" alt="{{.Name}}" class="device-image">
            <h3 class="device-name">{{.Name}}</h3>
            <p class="device-description">{{.Description}}</p>
            <div class="device-buttons">
                <a href="/devices/{{.ID}}" class="btn-details">Подробнее</a>
                <button class="btn-add" onclick="addToCart('{{.ID}}')">Добавить</button>
            </div>
        </div>
        {{else}}
        <div class="no-devices">
            <p>Устройства не найдены</p>
        </div>
        {{end}}
    </div>
</div>

<script>
function addToCart(deviceId) {
    fetch('/request/add', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/x-www-form-urlencoded',
        },
        body: 'service_id=' + deviceId
    })
    .then(response => {
        if (response.ok) {
            alert('Устройство добавлено в корзину');
            window.location.href = '/request';
        }
    })
    .catch(error => console.error('Error:', error));
}
</script>
{{end}}
